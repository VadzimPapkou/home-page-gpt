<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Домашняя страница</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@10">
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background-size: cover;
            background-position: center;
            background-image: url("https://images6.alphacoders.com/132/1328108.png");
            transition: background 0.5s ease-in-out;
            font-family: 'Arial', sans-serif;
        }

        #search-bar-container {
            position: relative;
            margin-top: 20px;
            width: 500px; /* Увеличил ширину для лучшего визуального эффекта */
        }

        #search-bar {
            width: 100%;
            padding: 10px 50px 10px 40px; /* Подкорректировал отступы для соответствия Google Search */
            font-size: 16px;
            border: 1px solid #dfe1e5; /* Цвет границы поля */
            border-radius: 24px; /* Более округлённые углы */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            outline: none;
        }

        #search-icon {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            left: 15px;
        }

        #search-icon img {
            width: 20px;
            height: 20px;
        }

        #microphone-icon {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            right: 15px;
            cursor: pointer;
        }

        #microphone-icon img {
            width: 20px;
            height: 20px;
        }

        #notes-container {
            position: relative;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
        }

        .note {
            position: absolute;
            cursor: grab;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 10px;
            user-select: none;
            transition: box-shadow 0.3s ease-in-out;
            background-color: #f8f8f8;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .note:hover {
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
        }

        .delete-button {
            position: absolute;
            top: 5px;
            right: 5px;
            cursor: pointer;
        }

        #custom-context-menu {
            display: none;
            position: absolute;
            background-color: #fff;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            border-radius: 5px;
            padding: 10px;
            z-index: 100;
        }

        body.swal2-height-auto.swal2-height-auto {
            height: 100vh !important;
        }

    </style>
</head>
<body>
<form id="search-bar-container" method="GET" action="https://www.google.com">
    <div id="search-icon">
        <img src="https://www.gstatic.com/images/icons/material/system/2x/search_black_24dp.png" alt="Search Icon">
    </div>
    <input name="q" type="text" id="search-bar" placeholder="Поиск в Google">
</form>
<div id="notes-container"></div>

<div id="custom-context-menu">
    <div onclick="showNoteDialog()">Создать заметку</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
<script>
  // Отображение кастомного контекстного меню
  function showContextMenu(x, y) {
    const contextMenu = document.getElementById('custom-context-menu');
    contextMenu.style.display = 'block';
    contextMenu.style.left = x + 'px';
    contextMenu.style.top = y + 'px';

    // Закрытие контекстного меню по клику вне его области
    document.addEventListener('click', function hideContextMenu() {
      contextMenu.style.display = 'none';
      document.removeEventListener('click', hideContextMenu);
    });
  }

  // Функция для отображения модального окна добавления заметки
  function showNoteDialog() {
    Swal.fire({
      title: 'Добавить заметку',
      html: `
                <input type="color" id="note-color" value="#ffcc00" style="margin-bottom: 10px;">
                <input type="text" id="note-size" placeholder="Размер заметки (например, 200px)" style="width: 100%; margin-bottom: 10px;" value="100px">
                <textarea id="note-content" placeholder="Текст заметки" style="width: 100%; height: 100px;"></textarea>
            `,
      focusConfirm: false,
      preConfirm: () => {
        const color = document.getElementById('note-color').value;
        const size = document.getElementById('note-size').value;
        const content = document.getElementById('note-content').value;

        if (!color || !size || !content) {
          Swal.showValidationMessage('Пожалуйста, заполните все поля');
          return;
        }

        const position = { x: 0, y: 0 }; // Начальные координаты
        addNote(color, size, content, position);
      }
    });
  }

  // Функция для добавления заметки
  function addNote(color, size, content, position) {
    const note = document.createElement("div");
    note.className = "note";
    note.draggable = true;

    note.style.backgroundColor = color;
    note.style.width = size;
    note.style.height = size;
    note.style.left = position.x + "px";
    note.style.top = position.y + "px";

    note.innerText = content;

    const deleteButton = document.createElement("span");
    deleteButton.className = "delete-button";
    deleteButton.innerHTML = "&#10006;"; // крестик
    deleteButton.addEventListener("click", function () {
      note.remove();
      saveNotes();
    });

    note.appendChild(deleteButton);

    // Добавляем обработчики событий
    addEventListenersToNote(note);

    document.getElementById("notes-container").appendChild(note);
    saveNotes();
  }

  // Функция для сохранения заметок в localStorage
  function saveNotes() {
    const notes = document.getElementById("notes-container").innerHTML;
    localStorage.setItem("notes", notes);
  }

  // Функция для загрузки заметок из localStorage
  function loadNotes() {
    const savedNotes = localStorage.getItem("notes");
    if (savedNotes) {
      document.getElementById("notes-container").innerHTML = savedNotes;
      // Добавляем обработчики событий к загруженным заметкам
      const loadedNotes = document.querySelectorAll(".note");
      loadedNotes.forEach((note) => {
        addEventListenersToNote(note);
      });
    }
  }

  // Загрузка сохраненных заметок при загрузке страницы
  window.onload = function () {
    loadNotes();
  };

  // Добавление обработчика события на правый клик
  document.addEventListener('contextmenu', function (event) {
    event.preventDefault();
    showContextMenu(event.clientX, event.clientY);
  });

  // Добавление обработчиков событий для заметки
  function addEventListenersToNote(note) {
    note.addEventListener("mousedown", function (e) {
      e.preventDefault();

      const offsetX = e.clientX - note.offsetLeft;
      const offsetY = e.clientY - note.offsetTop;

      document.addEventListener("mousemove", handleMouseMove);
      document.addEventListener("mouseup", handleMouseUp);

      function handleMouseMove(e) {
        note.style.left = e.clientX - offsetX + "px";
        note.style.top = e.clientY - offsetY + "px";
      }

      function handleMouseUp() {
        document.removeEventListener("mousemove", handleMouseMove);
        document.removeEventListener("mouseup", handleMouseUp);
        saveNotes();
      }
    });
    note.querySelector(".delete-button").addEventListener("click", e => {
      note.remove();
      saveNotes();
    })
  }
</script>
<script src="https://www.google.com/jsapi"></script>
</body>
</html>
